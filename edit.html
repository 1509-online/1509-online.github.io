<html>
<head>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="https://code.getmdl.io/1.2.1/material.grey-orange.min.css">
    <link rel="stylesheet" href="styles.css">
<title>Edit Dashboard</title>
<style>
    ul.tab {
        list-style-type: none;
        margin: 0;
        padding: 0;
        overflow: hidden;
        border: 1px solid #ccc;
        background-color: #f1f1f1;
    }

/* Float the list items side by side */
ul.tab li {float: left;}

/* Style the links inside the list items */
ul.tab li a {
    display: inline-block;
    color: black;
    text-align: center;
    padding: 14px 16px;
    text-decoration: none;
    transition: 0.3s;
    font-size: 17px;
}

/* Change background color of links on hover */
ul.tab li a:hover {background-color: #ddd;}

/* Create an active/current tablink class */
ul.tab li a:focus, .active {background-color: #ccc;}

/* Style the tab content */
.tabcontent {
    display: none;
    padding: 6px 12px;
    border: 1px solid #ccc;
    border-top: none;
}
</style>
</head>
<body>
    <button id="sign-out" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-color-text--white">
          <i class="material-icons">account_circle</i>Sign out
        </button><br>
    <ul class="tab">
        <li><a href="javascript:void(0)" class="tablinks" onclick="openTab(event, 'Edit')">New Article</a></li>
        <li><a href="javascript:void(0)" class="tablinks" onclick="openTab(event, 'Help')">Help</a></li>
    </ul>
    <div class="mdl-card something-else mdl-cell mdl-cell--8-col mdl-cell--4-col-desktop">
        <div class="mdl-card__media mdl-color--white mdl-color-text--grey-600">
    <div id="Edit" class="tabcontent">
        <h3>New Article</h3>
        <form action="#">
  <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
    <input class="mdl-textfield__input" type="text" id="title">
    <label class="mdl-textfield__label" for="title">Title</label>
  </div>
</form>
        <form action="#">
  <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
    <input class="mdl-textfield__input" type="text" id="user" pattern="[A-Z,a-z, ]*">
    <label class="mdl-textfield__label" for="user">Author Name</label>
  </div>
</form>
        <form action="#">
  <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
    <input class="mdl-textfield__input" type="text" pattern="[0-9,\]*" id="date">
    <label class="mdl-textfield__label" for="date">Date</label>
    <span class="mdl-textfield__error">That is not a valid date!</span>
  </div>
</form>
        <form action="#">
  <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
    <input class="mdl-textfield__input" type="text" id="image">
    <label class="mdl-textfield__label" for="image">Image URL (at least 820 pixels in width)</label>
  </div>
</form>
        <form action="#">
  <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
    <input class="mdl-textfield__input" type="text" id="summary">
    <label class="mdl-textfield__label" for="summary">Summary AND/OR Description</label>
  </div>
</form>
<form action="#">
  <div class="mdl-textfield mdl-js-textfield">
    <textarea class="mdl-textfield__input" type="text" rows="10" id="code" onchange="preview()"></textarea>
    <label class="mdl-textfield__label" for="code">Article Text</label>
  </div>
</form>
    <button id="publish" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-color-text--white">
          <i class="material-icons">check</i>Publish
        </button><br>
    <p id="preview"></p>
    </div>
            </div>
    
    <div id="Help" class="tabcontent">
        <h3>Help</h3>
        <p>For headers put # at the start and ## at the end. Example:<br># This will be a header ## <br>Will come out like this:<br></p><h2>This will be a header</h2><br>
        <p>For bold put * at the start and ** at the end. Example:<br>* This will be bold ** <br>Will come out like this:<br></p><b>This will be bold</b><br>
        <p>For italics put *** at the start and **** at the end. Example:<br>*** This will be in italics **** <br>Will come out like this:<br></p><i>This will be in italics</i><br>
        <p>For underline put _ at the start and __ (double underscore) at the end. Example:<br>_ This will be underlined __ <br>Will come out like this:<br></p><u>This will be underlined</u><br>
        <p>For embedding surveys and competitions, create a form in <a href="http://forms.google.com" target="_blank">Google Forms</a>, then in the top right corner, click send. Then click on <i class="material-icons">code</i>, copy the code at the bottom. In the article where you want the survey to appear type &lt;/p&gt;, then paste in the code and then type &lt;p&gt;</p>
    </div>
    
    
    <script>
        function openTab(evt, tabName) {
            var i, tabcontent, tablinks;
            tabcontent = document.getElementsByClassName("tabcontent");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
            }
            tablinks = document.getElementsByClassName("tablinks");
            for (i = 0; i < tablinks.length; i++) {
                tablinks[i].className = tablinks[i].className.replace(" active", "");
            }
            document.getElementById(tabName).style.display = "block";
            evt.currentTarget.className += " active";
        }
    </script>
<script src="https://www.gstatic.com/firebasejs/3.5.2/firebase.js"></script>
    <script src="https://www.gstatic.com/firebasejs/3.5.2/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/3.5.2/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/3.5.2/firebase-auth.js"></script>
    <script>
      // Initialize Firebase
      var config = {
        apiKey: "AIzaSyChG9cMyAkkZSXCZp1OmfpxbJYnJvh3XnQ",
        authDomain: "online-eff31.firebaseapp.com",
        databaseURL: "https://online-eff31.firebaseio.com",
        storageBucket: "online-eff31.appspot.com",
        messagingSenderId: "655714895872"
      };
      firebase.initializeApp(config);
        /*var provider = new firebase.auth.GoogleAuthProvider();*/
        firebase.auth().onAuthStateChanged(function(user) {
  if (user) {
    // User is signed in.
  } else {
    // No user is signed in.
      window.location = "https://1509-online.github.io/index.html"
  }
});
        
        
        document.getElementById("sign-out").addEventListener("click", function(){
        firebase.auth().signOut().then(function() {
  // Sign-out successful.
}, function(error) {
  // An error happened.
});
        });
        
        function preview() {
            var text = document.getElementById("code").value;
            document.getElementById("preview").innerHTML = text;
        }
        
        document.getElementById("publish").addEventListener("click", function(){
            var title = document.getElementById("title").value;
            var article = document.getElementById("code").value;
            var user = document.getElementById("user").value;
            var date = document.getElementById("date").value;
            var description = document.getElementById("summary").value;
            var image = document.getElementById("image").value;
            //To prevent accidents. I had one and it deleted everything :(
            if (title != "") {
            var articleRef = firebase.database().ref('entries/' + title);
            // An article entry.
            articleRef.set({ body: style(article), user: user, date: date, summary: description, image: image })
            .then(function() {
                  console.log('Synchronization succeeded');
                  alert("Success");
                  var title = document.getElementById("title").value = "";
                  var article = document.getElementById("code").value = "";
                  var user = document.getElementById("user").value = "";
                  var date = document.getElementById("date").value = "";
                  var description = document.getElementById("summary").value = "";
                  var image = document.getElementById("image").value = "";
                document.getElementById("preview").innerHTML = "";
                  })
                  .catch(function(error) {
                         console.log('Synchronization failed');
                         alert(error);
                    });
            } else {
                alert("Add a title");
            }
});
function preview() {
    var text = style(document.getElementById("code").value);
    document.getElementById("preview").innerHTML = text;
}
    function style(text) {
        //Newline \n
        returnText = text.replace(/\n/g,"<br>");
        //Header <h2> # ##
        returnText = returnText.replace(/##/g,"</h2>");
        returnText = returnText.replace(/#/g,"<h2>");
        //Italics <i> *** ****
        returnText = returnText.replace(/\*\*\*\*/g,"</i>");
        returnText = returnText.replace(/\*\*\*/g,"<i>");
        //Bold <b> * **
        returnText = returnText.replace(/\*\*/g,"</b>");
        returnText = returnText.replace(/\*/g,"<b>");
        //Underline <u> _ __
        returnText = returnText.replace(/__/g,"</u>");
        returnText = returnText.replace(/_/g,"<u>");
        return returnText;
    }

      </script>
      </body>
      </html>
